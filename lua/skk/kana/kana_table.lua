---@class KanaRule
---@field input string
---@field output string
---@field next string

---@type KanaRule[]
local kanaRules = {
  { input = "-", output = "ー", next = "" },
  { input = "~", output = "〜", next = "" },
  { input = ".", output = "。", next = "" },
  { input = ",", output = "、", next = "" },
  { input = "z/", output = "・", next = "" },
  { input = "z.", output = "…", next = "" },
  { input = "z,", output = "‥", next = "" },
  { input = "zh", output = "←", next = "" },
  { input = "zj", output = "↓", next = "" },
  { input = "zk", output = "↑", next = "" },
  { input = "zl", output = "→", next = "" },
  { input = "z-", output = "〜", next = "" },
  { input = "z[", output = "『", next = "" },
  { input = "z]", output = "』", next = "" },
  { input = "[", output = "「", next = "" },
  { input = "]", output = "」", next = "" },
  { input = "va", output = "ゔぁ", next = "" },
  { input = "vi", output = "ゔぃ", next = "" },
  { input = "vu", output = "ゔ", next = "" },
  { input = "ve", output = "ゔぇ", next = "" },
  { input = "vo", output = "ゔぉ", next = "" },
  { input = "vya", output = "ゔゃ", next = "" },
  { input = "vyi", output = "ゔぃ", next = "" },
  { input = "vyu", output = "ゔゅ", next = "" },
  { input = "vye", output = "ゔぇ", next = "" },
  { input = "vyo", output = "ゔょ", next = "" },
  { input = "qq", output = "っ", next = "q" },
  { input = "vv", output = "っ", next = "v" },
  { input = "ll", output = "っ", next = "l" },
  { input = "xx", output = "っ", next = "x" },
  { input = "kk", output = "っ", next = "k" },
  { input = "gg", output = "っ", next = "g" },
  { input = "ss", output = "っ", next = "s" },
  { input = "zz", output = "っ", next = "z" },
  { input = "jj", output = "っ", next = "j" },
  { input = "tt", output = "っ", next = "t" },
  { input = "dd", output = "っ", next = "d" },
  { input = "hh", output = "っ", next = "h" },
  { input = "ff", output = "っ", next = "f" },
  { input = "bb", output = "っ", next = "b" },
  { input = "pp", output = "っ", next = "p" },
  { input = "mm", output = "っ", next = "m" },
  { input = "yy", output = "っ", next = "y" },
  { input = "rr", output = "っ", next = "r" },
  { input = "ww", output = "っ", next = "w" },
  { input = "www", output = "w", next = "ww" },
  { input = "cc", output = "っ", next = "c" },
  { input = "kya", output = "きゃ", next = "" },
  { input = "kyi", output = "きぃ", next = "" },
  { input = "kyu", output = "きゅ", next = "" },
  { input = "kye", output = "きぇ", next = "" },
  { input = "kyo", output = "きょ", next = "" },
  { input = "gya", output = "ぎゃ", next = "" },
  { input = "gyi", output = "ぎぃ", next = "" },
  { input = "gyu", output = "ぎゅ", next = "" },
  { input = "gye", output = "ぎぇ", next = "" },
  { input = "gyo", output = "ぎょ", next = "" },
  { input = "sya", output = "しゃ", next = "" },
  { input = "syi", output = "しぃ", next = "" },
  { input = "syu", output = "しゅ", next = "" },
  { input = "sye", output = "しぇ", next = "" },
  { input = "syo", output = "しょ", next = "" },
  { input = "sha", output = "しゃ", next = "" },
  { input = "shi", output = "し", next = "" },
  { input = "shu", output = "しゅ", next = "" },
  { input = "she", output = "しぇ", next = "" },
  { input = "sho", output = "しょ", next = "" },
  { input = "zya", output = "じゃ", next = "" },
  { input = "zyi", output = "じぃ", next = "" },
  { input = "zyu", output = "じゅ", next = "" },
  { input = "zye", output = "じぇ", next = "" },
  { input = "zyo", output = "じょ", next = "" },
  { input = "tya", output = "ちゃ", next = "" },
  { input = "tyi", output = "ちぃ", next = "" },
  { input = "tyu", output = "ちゅ", next = "" },
  { input = "tye", output = "ちぇ", next = "" },
  { input = "tyo", output = "ちょ", next = "" },
  { input = "cha", output = "ちゃ", next = "" },
  { input = "chi", output = "ち", next = "" },
  { input = "chu", output = "ちゅ", next = "" },
  { input = "che", output = "ちぇ", next = "" },
  { input = "cho", output = "ちょ", next = "" },
  { input = "cya", output = "ちゃ", next = "" },
  { input = "cyi", output = "ちぃ", next = "" },
  { input = "cyu", output = "ちゅ", next = "" },
  { input = "cye", output = "ちぇ", next = "" },
  { input = "cyo", output = "ちょ", next = "" },
  { input = "dya", output = "ぢゃ", next = "" },
  { input = "dyi", output = "ぢぃ", next = "" },
  { input = "dyu", output = "ぢゅ", next = "" },
  { input = "dye", output = "ぢぇ", next = "" },
  { input = "dyo", output = "ぢょ", next = "" },
  { input = "tsa", output = "つぁ", next = "" },
  { input = "tsi", output = "つぃ", next = "" },
  { input = "tse", output = "つぇ", next = "" },
  { input = "tso", output = "つぉ", next = "" },
  { input = "tha", output = "てゃ", next = "" },
  { input = "thi", output = "てぃ", next = "" },
  { input = "t'i", output = "てぃ", next = "" },
  { input = "thu", output = "てゅ", next = "" },
  { input = "the", output = "てぇ", next = "" },
  { input = "tho", output = "てょ", next = "" },
  { input = "t'yu", output = "てゅ", next = "" },
  { input = "dha", output = "でゃ", next = "" },
  { input = "dhi", output = "でぃ", next = "" },
  { input = "d'i", output = "でぃ", next = "" },
  { input = "dhu", output = "でゅ", next = "" },
  { input = "dhe", output = "でぇ", next = "" },
  { input = "dho", output = "でょ", next = "" },
  { input = "d'yu", output = "でゅ", next = "" },
  { input = "twa", output = "とぁ", next = "" },
  { input = "twi", output = "とぃ", next = "" },
  { input = "twu", output = "とぅ", next = "" },
  { input = "twe", output = "とぇ", next = "" },
  { input = "two", output = "とぉ", next = "" },
  { input = "t'u", output = "とぅ", next = "" },
  { input = "dwa", output = "どぁ", next = "" },
  { input = "dwi", output = "どぃ", next = "" },
  { input = "dwu", output = "どぅ", next = "" },
  { input = "dwe", output = "どぇ", next = "" },
  { input = "dwo", output = "どぉ", next = "" },
  { input = "d'u", output = "どぅ", next = "" },
  { input = "nya", output = "にゃ", next = "" },
  { input = "nyi", output = "にぃ", next = "" },
  { input = "nyu", output = "にゅ", next = "" },
  { input = "nye", output = "にぇ", next = "" },
  { input = "nyo", output = "にょ", next = "" },
  { input = "hya", output = "ひゃ", next = "" },
  { input = "hyi", output = "ひぃ", next = "" },
  { input = "hyu", output = "ひゅ", next = "" },
  { input = "hye", output = "ひぇ", next = "" },
  { input = "hyo", output = "ひょ", next = "" },
  { input = "bya", output = "びゃ", next = "" },
  { input = "byi", output = "びぃ", next = "" },
  { input = "byu", output = "びゅ", next = "" },
  { input = "bye", output = "びぇ", next = "" },
  { input = "byo", output = "びょ", next = "" },
  { input = "pya", output = "ぴゃ", next = "" },
  { input = "pyi", output = "ぴぃ", next = "" },
  { input = "pyu", output = "ぴゅ", next = "" },
  { input = "pye", output = "ぴぇ", next = "" },
  { input = "pyo", output = "ぴょ", next = "" },
  { input = "fa", output = "ふぁ", next = "" },
  { input = "fi", output = "ふぃ", next = "" },
  { input = "fu", output = "ふ", next = "" },
  { input = "fe", output = "ふぇ", next = "" },
  { input = "fo", output = "ふぉ", next = "" },
  { input = "fya", output = "ふゃ", next = "" },
  { input = "fyu", output = "ふゅ", next = "" },
  { input = "fyo", output = "ふょ", next = "" },
  { input = "hwa", output = "ふぁ", next = "" },
  { input = "hwi", output = "ふぃ", next = "" },
  { input = "hwe", output = "ふぇ", next = "" },
  { input = "hwo", output = "ふぉ", next = "" },
  { input = "hwyu", output = "ふゅ", next = "" },
  { input = "mya", output = "みゃ", next = "" },
  { input = "myi", output = "みぃ", next = "" },
  { input = "myu", output = "みゅ", next = "" },
  { input = "mye", output = "みぇ", next = "" },
  { input = "myo", output = "みょ", next = "" },
  { input = "rya", output = "りゃ", next = "" },
  { input = "ryi", output = "りぃ", next = "" },
  { input = "ryu", output = "りゅ", next = "" },
  { input = "rye", output = "りぇ", next = "" },
  { input = "ryo", output = "りょ", next = "" },
  { input = "n'", output = "ん", next = "" },
  { input = "nn", output = "ん", next = "" },
  { input = "n", output = "ん", next = "" },
  { input = "xn", output = "ん", next = "" },
  { input = "a", output = "あ", next = "" },
  { input = "i", output = "い", next = "" },
  { input = "u", output = "う", next = "" },
  { input = "wu", output = "う", next = "" },
  { input = "e", output = "え", next = "" },
  { input = "o", output = "お", next = "" },
  { input = "xa", output = "ぁ", next = "" },
  { input = "xi", output = "ぃ", next = "" },
  { input = "xu", output = "ぅ", next = "" },
  { input = "xe", output = "ぇ", next = "" },
  { input = "xo", output = "ぉ", next = "" },
  { input = "la", output = "ぁ", next = "" },
  { input = "li", output = "ぃ", next = "" },
  { input = "lu", output = "ぅ", next = "" },
  { input = "le", output = "ぇ", next = "" },
  { input = "lo", output = "ぉ", next = "" },
  { input = "lyi", output = "ぃ", next = "" },
  { input = "xyi", output = "ぃ", next = "" },
  { input = "lye", output = "ぇ", next = "" },
  { input = "xye", output = "ぇ", next = "" },
  { input = "ye", output = "いぇ", next = "" },
  { input = "ka", output = "か", next = "" },
  { input = "ki", output = "き", next = "" },
  { input = "ku", output = "く", next = "" },
  { input = "ke", output = "け", next = "" },
  { input = "ko", output = "こ", next = "" },
  { input = "xka", output = "ヵ", next = "" },
  { input = "xke", output = "ヶ", next = "" },
  { input = "lka", output = "ヵ", next = "" },
  { input = "lke", output = "ヶ", next = "" },
  { input = "ga", output = "が", next = "" },
  { input = "gi", output = "ぎ", next = "" },
  { input = "gu", output = "ぐ", next = "" },
  { input = "ge", output = "げ", next = "" },
  { input = "go", output = "ご", next = "" },
  { input = "sa", output = "さ", next = "" },
  { input = "si", output = "し", next = "" },
  { input = "su", output = "す", next = "" },
  { input = "se", output = "せ", next = "" },
  { input = "so", output = "そ", next = "" },
  { input = "ca", output = "か", next = "" },
  { input = "ci", output = "し", next = "" },
  { input = "cu", output = "く", next = "" },
  { input = "ce", output = "せ", next = "" },
  { input = "co", output = "こ", next = "" },
  { input = "qa", output = "くぁ", next = "" },
  { input = "qi", output = "くぃ", next = "" },
  { input = "qu", output = "く", next = "" },
  { input = "qe", output = "くぇ", next = "" },
  { input = "qo", output = "くぉ", next = "" },
  { input = "kwa", output = "くぁ", next = "" },
  { input = "kwi", output = "くぃ", next = "" },
  { input = "kwu", output = "くぅ", next = "" },
  { input = "kwe", output = "くぇ", next = "" },
  { input = "kwo", output = "くぉ", next = "" },
  { input = "gwa", output = "ぐぁ", next = "" },
  { input = "gwi", output = "ぐぃ", next = "" },
  { input = "gwu", output = "ぐぅ", next = "" },
  { input = "gwe", output = "ぐぇ", next = "" },
  { input = "gwo", output = "ぐぉ", next = "" },
  { input = "swa", output = "すぁ", next = "" },
  { input = "swi", output = "すぃ", next = "" },
  { input = "swu", output = "すぅ", next = "" },
  { input = "swe", output = "すぇ", next = "" },
  { input = "swo", output = "すぉ", next = "" },
  { input = "zwa", output = "ずぁ", next = "" },
  { input = "zwi", output = "ずぃ", next = "" },
  { input = "zwu", output = "ずぅ", next = "" },
  { input = "zwe", output = "ずぇ", next = "" },
  { input = "zwo", output = "ずぉ", next = "" },
  { input = "za", output = "ざ", next = "" },
  { input = "zi", output = "じ", next = "" },
  { input = "zu", output = "ず", next = "" },
  { input = "ze", output = "ぜ", next = "" },
  { input = "zo", output = "ぞ", next = "" },
  { input = "ja", output = "じゃ", next = "" },
  { input = "ji", output = "じ", next = "" },
  { input = "ju", output = "じゅ", next = "" },
  { input = "je", output = "じぇ", next = "" },
  { input = "jo", output = "じょ", next = "" },
  { input = "jya", output = "じゃ", next = "" },
  { input = "jyi", output = "じぃ", next = "" },
  { input = "jyu", output = "じゅ", next = "" },
  { input = "jye", output = "じぇ", next = "" },
  { input = "jyo", output = "じょ", next = "" },
  { input = "ta", output = "た", next = "" },
  { input = "ti", output = "ち", next = "" },
  { input = "tu", output = "つ", next = "" },
  { input = "tsu", output = "つ", next = "" },
  { input = "te", output = "て", next = "" },
  { input = "to", output = "と", next = "" },
  { input = "da", output = "だ", next = "" },
  { input = "di", output = "ぢ", next = "" },
  { input = "du", output = "づ", next = "" },
  { input = "de", output = "で", next = "" },
  { input = "do", output = "ど", next = "" },
  { input = "xtu", output = "っ", next = "" },
  { input = "xtsu", output = "っ", next = "" },
  { input = "ltu", output = "っ", next = "" },
  { input = "ltsu", output = "っ", next = "" },
  { input = "na", output = "な", next = "" },
  { input = "ni", output = "に", next = "" },
  { input = "nu", output = "ぬ", next = "" },
  { input = "ne", output = "ね", next = "" },
  { input = "no", output = "の", next = "" },
  { input = "ha", output = "は", next = "" },
  { input = "hi", output = "ひ", next = "" },
  { input = "hu", output = "ふ", next = "" },
  { input = "fu", output = "ふ", next = "" },
  { input = "he", output = "へ", next = "" },
  { input = "ho", output = "ほ", next = "" },
  { input = "ba", output = "ば", next = "" },
  { input = "bi", output = "び", next = "" },
  { input = "bu", output = "ぶ", next = "" },
  { input = "be", output = "べ", next = "" },
  { input = "bo", output = "ぼ", next = "" },
  { input = "pa", output = "ぱ", next = "" },
  { input = "pi", output = "ぴ", next = "" },
  { input = "pu", output = "ぷ", next = "" },
  { input = "pe", output = "ぺ", next = "" },
  { input = "po", output = "ぽ", next = "" },
  { input = "ma", output = "ま", next = "" },
  { input = "mi", output = "み", next = "" },
  { input = "mu", output = "む", next = "" },
  { input = "me", output = "め", next = "" },
  { input = "mo", output = "も", next = "" },
  { input = "xya", output = "ゃ", next = "" },
  { input = "lya", output = "ゃ", next = "" },
  { input = "ya", output = "や", next = "" },
  { input = "wyi", output = "ゐ", next = "" },
  { input = "xyu", output = "ゅ", next = "" },
  { input = "lyu", output = "ゅ", next = "" },
  { input = "yu", output = "ゆ", next = "" },
  { input = "wye", output = "ゑ", next = "" },
  { input = "xyo", output = "ょ", next = "" },
  { input = "lyo", output = "ょ", next = "" },
  { input = "yo", output = "よ", next = "" },
  { input = "ra", output = "ら", next = "" },
  { input = "ri", output = "り", next = "" },
  { input = "ru", output = "る", next = "" },
  { input = "re", output = "れ", next = "" },
  { input = "ro", output = "ろ", next = "" },
  { input = "xwa", output = "ゎ", next = "" },
  { input = "lwa", output = "ゎ", next = "" },
  { input = "wa", output = "わ", next = "" },
  { input = "wi", output = "うぃ", next = "" },
  { input = "we", output = "うぇ", next = "" },
  { input = "wo", output = "を", next = "" },
  { input = "wha", output = "うぁ", next = "" },
  { input = "whi", output = "うぃ", next = "" },
  { input = "whu", output = "う", next = "" },
  { input = "whe", output = "うぇ", next = "" },
  { input = "who", output = "うぉ", next = "" },
}

---@class KanaTable
---@field rules KanaRule[]
local KanaTable = {
  rules = kanaRules,
}

---@return KanaTable
function KanaTable.new()
  return setmetatable({}, { __index = KanaTable })
end

---inputとの前方一致で絞り込む
---@param pre string
---@return KanaRule[]
function KanaTable:filter(pre)
  return vim.tbl_filter(function(rule)
    return vim.startswith(rule.input, pre)
  end, self.rules)
end

return KanaTable
